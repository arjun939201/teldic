<!DOCTYPE html>
<html lang="te">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Telugu Tracing Practice</title>

<style>
body{
    margin:0;
    font-family:Arial, sans-serif;
    background:#f2fbff;
    text-align:center;
}

h1{
    margin:15px 0 5px;
}

#progress{
    font-weight:bold;
    margin-bottom:5px;
}

svg{
    width:95%;
    max-width:500px;
    height:400px;
    background:white;
    border-radius:15px;
    box-shadow:0 4px 10px rgba(0,0,0,0.1);
    touch-action:none;
}

.guide{
    fill:none;
    stroke:#ddd;
    stroke-width:8;
    stroke-linecap:round;
    stroke-linejoin:round;
}

.trace{
    fill:none;
    stroke:#4CAF50;
    stroke-width:8;
    stroke-linecap:round;
    stroke-linejoin:round;
}

#glider{
    fill:#ff5722;
}

button{
    padding:8px 18px;
    margin:8px;
    border:none;
    border-radius:8px;
    font-size:16px;
    background:#4CAF50;
    color:white;
}

button:hover{
    background:#388e3c;
}

#message{
    font-size:18px;
    color:green;
    margin-top:5px;
}
</style>
</head>

<body>

<h1>తెలుగు అక్షరాల ట్రేసింగ్</h1>
<div id="progress"></div>

<svg id="svg" viewBox="0 0 400 400">
    <path id="guide" class="guide"></path>
    <path id="trace" class="trace"></path>
    <circle id="glider" r="10"></circle>
</svg>

<div>
    <button onclick="prevLetter()">Previous</button>
    <button onclick="reset()">Reset</button>
    <button onclick="nextLetter()">Next</button>
</div>

<div id="message"></div>

<script>
// ALL TELUGU LETTERS
const letters = [
"అ","ఆ","ఇ","ఈ","ఉ","ఊ","ఋ","ౠ","ఎ","ఏ","ఐ","ఒ","ఓ","ఔ","అం","అః",
"క","ఖ","గ","ఘ","ఙ",
"చ","ఛ","జ","ఝ","ఞ",
"ట","ఠ","డ","ఢ","ణ",
"త","థ","ద","ధ","న",
"ప","ఫ","బ","భ","మ",
"య","ర","ల","వ",
"శ","ష","స","హ",
"ళ","క్ష","ఱ"
];

let current = 0;
let totalLength = 0;
let currentLength = 0;
let dragging = false;

const guide = document.getElementById("guide");
const trace = document.getElementById("trace");
const glider = document.getElementById("glider");
const svg = document.getElementById("svg");
const progress = document.getElementById("progress");
const message = document.getElementById("message");

// Convert letter to SVG path using text
function createLetterPath(letter){
    const tempSvg = document.createElementNS("http://www.w3.org/2000/svg","svg");
    const text = document.createElementNS("http://www.w3.org/2000/svg","text");

    text.setAttribute("x",200);
    text.setAttribute("y",230);
    text.setAttribute("text-anchor","middle");
    text.setAttribute("font-size","220");
    text.setAttribute("font-family","Noto Sans Telugu, Arial");
    text.textContent = letter;

    tempSvg.appendChild(text);
    document.body.appendChild(tempSvg);

    const bbox = text.getBBox();
    const pathData = text.outerHTML;

    document.body.removeChild(tempSvg);

    // Use generic curved track as fallback track shape
    return "M80 200 Q200 50 320 200 Q200 350 80 200";
}

function loadLetter(){
    message.textContent = "";
    const pathData = createLetterPath(letters[current]);

    guide.setAttribute("d",pathData);
    trace.setAttribute("d",pathData);

    totalLength = guide.getTotalLength();
    guide.style.strokeDasharray = totalLength;
    guide.style.strokeDashoffset = 0;

    trace.style.strokeDasharray = totalLength;
    trace.style.strokeDashoffset = totalLength;

    currentLength = 0;

    const start = guide.getPointAtLength(0);
    glider.setAttribute("cx",start.x);
    glider.setAttribute("cy",start.y);

    progress.textContent = `Letter ${current+1} of ${letters.length} : ${letters[current]}`;
}

function updateGlider(){
    const point = guide.getPointAtLength(currentLength);
    glider.setAttribute("cx",point.x);
    glider.setAttribute("cy",point.y);

    trace.style.strokeDashoffset = totalLength - currentLength;

    if(currentLength >= totalLength * 0.95){
        message.textContent = "Well done!";
        beep();
    }
}

function getPosition(evt){
    const CTM = svg.getScreenCTM();
    const clientX = evt.touches ? evt.touches[0].clientX : evt.clientX;
    return (clientX - CTM.e) / CTM.a;
}

function startDrag(e){ dragging=true; }
function stopDrag(){ dragging=false; }

function drag(e){
    if(!dragging) return;
    e.preventDefault();

    let movement = 5; 
    currentLength += movement;

    if(currentLength > totalLength)
        currentLength = totalLength;

    updateGlider();
}

function reset(){
    currentLength = 0;
    trace.style.strokeDashoffset = totalLength;
    const start = guide.getPointAtLength(0);
    glider.setAttribute("cx",start.x);
    glider.setAttribute("cy",start.y);
    message.textContent = "";
}

function nextLetter(){
    if(current < letters.length-1){
        current++;
        loadLetter();
    }
}

function prevLetter(){
    if(current > 0){
        current--;
        loadLetter();
    }
}

function beep(){
    const ctx = new (window.AudioContext||window.webkitAudioContext)();
    const osc = ctx.createOscillator();
    osc.connect(ctx.destination);
    osc.frequency.value=600;
    osc.start();
    osc.stop(ctx.currentTime+0.1);
}

// Events
svg.addEventListener("mousedown",startDrag);
svg.addEventListener("mouseup",stopDrag);
svg.addEventListener("mousemove",drag);

svg.addEventListener("touchstart",startDrag);
svg.addEventListener("touchend",stopDrag);
svg.addEventListener("touchmove",drag);

loadLetter();
</script>

</body>
</html>
