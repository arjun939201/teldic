<!DOCTYPE html>
<html lang="te">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Telugu Stroke-Based Tracing</title>

<style>
body{
    margin:0;
    font-family:Arial, sans-serif;
    background:#f4fbff;
    text-align:center;
}

h2{margin:10px 0;}

svg{
    width:95%;
    max-width:500px;
    height:350px;
    background:white;
    border-radius:12px;
    margin:10px auto;
    box-shadow:0 4px 8px rgba(0,0,0,0.1);
    touch-action:none;
}

.guide{
    fill:none;
    stroke:#ddd;
    stroke-width:6;
    stroke-linecap:round;
    stroke-linejoin:round;
}

.trace{
    fill:none;
    stroke:#4CAF50;
    stroke-width:6;
    stroke-linecap:round;
}

.demoTrace{
    fill:none;
    stroke:#2196F3;
    stroke-width:6;
}

.glider{
    fill:#ff5722;
}

button{
    padding:8px 18px;
    margin:5px;
    border:none;
    border-radius:6px;
    background:#4CAF50;
    color:white;
}
</style>
</head>
<body>

<h2>తెలుగు స్ట్రోక్ ట్రేసింగ్</h2>
<div id="letterLabel"></div>

<svg id="demoSvg"></svg>
<svg id="practiceSvg"></svg>

<div>
<button onclick="prevLetter()">Previous</button>
<button onclick="resetPractice()">Reset</button>
<button onclick="nextLetter()">Next</button>
</div>

<script>

// -------- STROKE DATABASE (Extend this for full system) --------
const strokeData = {
    "అ": [
        "M120 150 Q200 80 300 150",
        "M200 150 Q200 220 260 260"
    ],
    "ఆ": [
        "M120 150 Q200 80 300 150",
        "M200 150 Q200 220 260 260",
        "M300 150 Q350 200 300 260"
    ],
    "ఇ": [
        "M180 100 Q200 160 180 240",
        "M180 140 Q240 120 260 160"
    ],
    "ఈ": [
        "M180 100 Q200 160 180 240",
        "M180 140 Q260 110 290 160"
    ],
    "ఉ": [
        "M150 120 Q200 90 250 120",
        "M200 120 Q200 200 250 260"
    ],
    "ఊ": [
        "M150 120 Q200 90 250 120",
        "M200 120 Q200 200 250 260",
        "M250 120 Q300 160 250 200"
    ]
};

// --------- Setup ---------
const letters = Object.keys(strokeData);
let currentLetterIndex = 0;
let currentStrokeIndex = 0;
let dragging = false;
let currentLength = 0;
let totalLength = 0;

const demoSvg = document.getElementById("demoSvg");
const practiceSvg = document.getElementById("practiceSvg");
const label = document.getElementById("letterLabel");

// SVG Setup
function createBase(svg){
    svg.setAttribute("viewBox","0 0 400 300");
    svg.innerHTML = `
        <path class="guide"/>
        <path class="trace"/>
        <circle class="glider" r="7"/>
    `;
}
createBase(demoSvg);
createBase(practiceSvg);

function loadLetter(){
    const letter = letters[currentLetterIndex];
    label.textContent = `Letter: ${letter}`;
    currentStrokeIndex = 0;
    loadStroke();
}

function loadStroke(){
    const letter = letters[currentLetterIndex];
    const strokes = strokeData[letter];
    const pathData = strokes[currentStrokeIndex];

    setupSVG(demoSvg, pathData, true);
    setupSVG(practiceSvg, pathData, false);
}

function setupSVG(svg, pathData, isDemo){
    const guide = svg.querySelector(".guide");
    const trace = svg.querySelector(".trace");
    const glider = svg.querySelector(".glider");

    guide.setAttribute("d", pathData);
    trace.setAttribute("d", pathData);

    const length = guide.getTotalLength();

    guide.style.strokeDasharray = length;
    guide.style.strokeDashoffset = 0;

    trace.style.strokeDasharray = length;
    trace.style.strokeDashoffset = length;

    const start = guide.getPointAtLength(0);
    glider.setAttribute("cx", start.x);
    glider.setAttribute("cy", start.y);

    if(!isDemo){
        totalLength = length;
        currentLength = 0;
    }
}

// -------- Practice Logic --------
practiceSvg.addEventListener("mousedown", ()=> dragging=true);
practiceSvg.addEventListener("mouseup", ()=> dragging=false);
practiceSvg.addEventListener("mousemove", movePractice);

function movePractice(e){
    if(!dragging) return;

    currentLength += 4;
    if(currentLength > totalLength)
        currentLength = totalLength;

    updatePractice(currentLength);

    if(currentLength >= totalLength){
        nextStroke();
    }
}

function updatePractice(len){
    const guide = practiceSvg.querySelector(".guide");
    const trace = practiceSvg.querySelector(".trace");
    const glider = practiceSvg.querySelector(".glider");

    trace.style.strokeDashoffset = totalLength - len;

    const p = guide.getPointAtLength(len);
    glider.setAttribute("cx", p.x);
    glider.setAttribute("cy", p.y);
}

function nextStroke(){
    const strokes = strokeData[letters[currentLetterIndex]];
    if(currentStrokeIndex < strokes.length-1){
        currentStrokeIndex++;
        loadStroke();
    }
}

// -------- Demo Animation --------
function animateDemo(){
    const guide = demoSvg.querySelector(".guide");
    const trace = demoSvg.querySelector(".trace");
    const glider = demoSvg.querySelector(".glider");

    let len = guide.getTotalLength();
    let progress = 0;

    function loop(){
        progress += 2;

        if(progress > len){
            progress = 0;
        }

        trace.style.strokeDashoffset = len - progress;
        const p = guide.getPointAtLength(progress);
        glider.setAttribute("cx", p.x);
        glider.setAttribute("cy", p.y);

        requestAnimationFrame(loop);
    }
    loop();
}

// -------- Navigation --------
function nextLetter(){
    if(currentLetterIndex < letters.length-1){
        currentLetterIndex++;
        loadLetter();
    }
}

function prevLetter(){
    if(currentLetterIndex > 0){
        currentLetterIndex--;
        loadLetter();
    }
}

function resetPractice(){
    loadStroke();
}

loadLetter();
animateDemo();

</script>
</body>
</html>
