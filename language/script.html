<!DOCTYPE html>
<html lang="te">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Telugu Letter Tracing with Demo</title>

<script src="https://cdn.jsdelivr.net/npm/opentype.js@latest/dist/opentype.min.js"></script>

<style>
body{
    margin:0;
    font-family:Arial, sans-serif;
    background:#f2fbff;
    text-align:center;
}

h1{ margin:10px 0; }

.container{
    width:95%;
    max-width:550px;
    margin:auto;
}

svg{
    width:100%;
    height:250px;
    background:white;
    border-radius:12px;
    margin:10px 0;
    box-shadow:0 4px 8px rgba(0,0,0,0.1);
    touch-action:none;
}

.guide{
    fill:none;
    stroke:#ddd;
    stroke-width:6;
    stroke-linejoin:round;
}

.trace{
    fill:none;
    stroke:#4CAF50;
    stroke-width:6;
    stroke-linejoin:round;
}

.demoTrace{
    fill:none;
    stroke:#2196F3;
    stroke-width:6;
}

.glider{
    fill:#ff5722;
}

button{
    padding:8px 16px;
    margin:5px;
    border:none;
    border-radius:6px;
    background:#4CAF50;
    color:white;
}

#progress{
    font-weight:bold;
}
</style>
</head>
<body>

<h1>తెలుగు ట్రేసింగ్</h1>

<div class="container">

<div id="progress"></div>

<!-- DEMO SVG -->
<svg id="demoSvg" viewBox="0 0 500 250">
    <path id="demoGuide" class="guide"></path>
    <path id="demoTrace" class="demoTrace"></path>
    <circle id="demoGlider" class="glider" r="7"></circle>
</svg>

<!-- PRACTICE SVG -->
<svg id="practiceSvg" viewBox="0 0 500 250">
    <path id="guide" class="guide"></path>
    <path id="trace" class="trace"></path>
    <circle id="glider" class="glider" r="7"></circle>
</svg>

<div>
<button onclick="prevLetter()">Previous</button>
<button onclick="resetPractice()">Reset</button>
<button onclick="nextLetter()">Next</button>
</div>

</div>

<script>

const letters = [
"అ","ఆ","ఇ","ఈ","ఉ","ఊ","ఋ","ౠ","ఎ","ఏ","ఐ","ఒ","ఓ","ఔ","అం","అః",
"క","ఖ","గ","ఘ","ఙ",
"చ","ఛ","జ","ఝ","ఞ",
"ట","ఠ","డ","ఢ","ణ",
"త","థ","ద","ధ","న",
"ప","ఫ","బ","భ","మ",
"య","ర","ల","వ",
"శ","ష","స","హ",
"ళ","క్ష","ఱ"
];

let font;
let current = 0;

// Practice variables
let totalLength = 0;
let currentLength = 0;
let dragging = false;

// Demo variables
let demoLength = 0;
let demoProgress = 0;

const guide = document.getElementById("guide");
const trace = document.getElementById("trace");
const glider = document.getElementById("glider");
const practiceSvg = document.getElementById("practiceSvg");

const demoGuide = document.getElementById("demoGuide");
const demoTrace = document.getElementById("demoTrace");
const demoGlider = document.getElementById("demoGlider");

const progress = document.getElementById("progress");

opentype.load(
'https://raw.githubusercontent.com/googlefonts/noto-fonts/main/hinted/ttf/NotoSansTelugu/NotoSansTelugu-Regular.ttf',
function(err, loadedFont){
    if(err){
        alert("Font load failed");
    }else{
        font = loadedFont;
        loadLetter();
        animateDemo();
    }
});

function createPath(letter){
    const path = font.getPath(letter, 50, 200, 180);
    return path.toPathData(2);
}

function loadLetter(){

    const pathData = createPath(letters[current]);

    // Practice
    guide.setAttribute("d", pathData);
    trace.setAttribute("d", pathData);
    totalLength = guide.getTotalLength();
    trace.style.strokeDasharray = totalLength;
    trace.style.strokeDashoffset = totalLength;
    currentLength = 0;
    setPracticeGlider(0);

    // Demo
    demoGuide.setAttribute("d", pathData);
    demoTrace.setAttribute("d", pathData);
    demoLength = demoGuide.getTotalLength();
    demoTrace.style.strokeDasharray = demoLength;
    demoTrace.style.strokeDashoffset = demoLength;
    demoProgress = 0;

    progress.textContent =
        `Letter ${current+1} of ${letters.length} : ${letters[current]}`;
}

function setPracticeGlider(len){
    const p = guide.getPointAtLength(len);
    glider.setAttribute("cx", p.x);
    glider.setAttribute("cy", p.y);
}

function setDemoGlider(len){
    const p = demoGuide.getPointAtLength(len);
    demoGlider.setAttribute("cx", p.x);
    demoGlider.setAttribute("cy", p.y);
}

function resetPractice(){
    currentLength = 0;
    trace.style.strokeDashoffset = totalLength;
    setPracticeGlider(0);
}

// PRACTICE CONTROL (NO AUTO MOVE)
practiceSvg.addEventListener("mousedown", ()=> dragging=true);
practiceSvg.addEventListener("mouseup", ()=> dragging=false);
practiceSvg.addEventListener("touchstart", ()=> dragging=true);
practiceSvg.addEventListener("touchend", ()=> dragging=false);

practiceSvg.addEventListener("mousemove", movePractice);
practiceSvg.addEventListener("touchmove", movePractice);

function movePractice(e){
    if(!dragging) return;
    e.preventDefault();

    currentLength += 4;
    if(currentLength > totalLength)
        currentLength = totalLength;

    trace.style.strokeDashoffset = totalLength - currentLength;
    setPracticeGlider(currentLength);
}

// DEMO AUTO LOOP
function animateDemo(){

    demoProgress += 2;

    if(demoProgress > demoLength){
        demoProgress = 0;
        demoTrace.style.strokeDashoffset = demoLength;
    }

    demoTrace.style.strokeDashoffset = demoLength - demoProgress;
    setDemoGlider(demoProgress);

    requestAnimationFrame(animateDemo);
}

function nextLetter(){
    if(current < letters.length-1){
        current++;
        loadLetter();
    }
}

function prevLetter(){
    if(current > 0){
        current--;
        loadLetter();
    }
}

</script>

</body>
</html>
