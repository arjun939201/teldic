<!DOCTYPE html>
<html lang="te">
<head>
  <meta charset="UTF-8" />
  <title>‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å ‡∞§‡±Ü‡∞≤‡±ç‡∞≤‡∞°‡∞ø</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { margin:0; font-family:"Noto Serif Telugu", serif; background:#f9f9f9; color:#222; }
    header { padding:16px; display:flex; gap:12px; align-items:center; justify-content:center; flex-wrap:wrap; }
    h1 { margin:0 0 6px; font-size:26px; text-align:center; width:100%; }
    select, input[type="text"] { padding:10px 12px; border:1px solid #ccc; border-radius:8px; font-size:15px; }
    #search { min-width:260px; }
    main { max-width:800px; margin:10px auto 40px; padding:0 16px; }
    ul { list-style:none; padding:0; margin:0; background:#fff; border:1px solid #e6e6e6; border-radius:12px; overflow:hidden; }
    li { padding:10px 12px; border-bottom:1px solid #f0f0f0; cursor:pointer; white-space:pre-wrap; }
    li:last-child { border-bottom:none; }
    li:hover { background:#fff8ec; }
    .empty { padding:18px; text-align:center; color:#777; }

    /* Popup */
    .overlay { display:none; position:fixed; inset:0; background:#0006; z-index:999; }
    .popup { display:none; position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); background:#fff; width:min(90vw,520px); border-radius:12px; box-shadow:0 10px 30px #0003; z-index:1000; }
    .popup header { padding:12px 16px; border-bottom:1px solid #eee; justify-content:space-between; }
    .popup h2 { margin:0; font-size:20px; color:#7a2d00; }
    .popup .body { padding:14px 16px; line-height:1.6; }
    .btn-close { border:0; background:#ef4444; color:#fff; padding:6px 10px; border-radius:8px; cursor:pointer; }
    .meta { color:#555; font-size:14px; }
  </style>
</head>
<body>
  <header>
    <h1>üìò ‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å ‡∞§‡±Ü‡∞≤‡±ç‡∞≤‡∞°‡∞ø</h1>
    <select id="category">
      <option value="noun.txt">‡∞™‡±á‡∞∞‡±Å‡∞ï‡∞≤‡±Å (Nouns)</option>
      <option value="pronoun.txt">‡∞Æ‡∞±‡±Å‡∞™‡±á‡∞∞‡±Å (Pronouns)</option>
      <option value="verb.txt">‡∞ö‡±à‡∞µ‡±Å‡∞≤‡±Å (Verbs)</option>
      <option value="adjective.txt">‡∞§‡∞®‡∞æ‡∞∞‡∞æ‡∞≤‡±Å (Adjectives)</option>
      <option value="adverb.txt">‡∞ö‡±á‡∞∞‡∞£‡±Å‡∞≤‡±Å (Adverbs)</option>
      <option value="synonyms.txt">‡∞∏‡∞æ‡∞ü‡∞ø‡∞Æ‡∞æ‡∞ü‡∞≤‡±Å (Synonyms)</option>
      <option value="antonyms.txt">‡∞é‡∞¶‡±Å‡∞∞‡±á‡∞ï ‡∞™‡∞¶‡∞æ‡∞≤‡±Å (Antonyms)</option>
      <option value="conjunctions.txt">‡∞Ö‡∞®‡±ç‡∞µ‡∞Ø‡∞æ‡∞≤‡±Å (Conjunctions)</option>
      <option value="prepositions.txt">‡∞â‡∞™‡∞∏‡∞∞‡±ç‡∞ó‡∞≤‡±Å (Prepositions)</option>
      <option value="interjections.txt">‡∞µ‡∞ø‡∞∏‡±ç‡∞Æ‡∞Ø‡∞æ‡∞¶‡∞ø‡∞¨‡±ã‡∞ß‡∞ï‡∞æ‡∞≤‡±Å (Interjections)</option>
      <option value="idioms.txt">‡∞™‡±ç‡∞∞‡∞∏‡∞ø‡∞¶‡±ç‡∞ß‡±ã‡∞ï‡±ç‡∞§‡±Å‡∞≤‡±Å (Idioms)</option>
      <option value="proverbs.txt">‡∞∏‡∞æ‡∞Æ‡±Ü‡∞§‡∞≤‡±Å (Proverbs)</option>
      <option value="phrasal_verbs.txt">‡∞â‡∞™‡∞∏‡∞∞‡±ç‡∞ó ‡∞ï‡±ç‡∞∞‡∞ø‡∞Ø‡∞≤‡±Å (Phrasal Verbs)</option>
      <option value="numbers.txt">‡∞∏‡∞Ç‡∞ñ‡±ç‡∞Ø‡∞≤‡±Å (Numbers)</option>
      <option value="quantifiers.txt">‡∞™‡∞∞‡∞ø‡∞Æ‡∞æ‡∞£ ‡∞™‡∞¶‡∞æ‡∞≤‡±Å (Quantifiers)</option>
      <option value="homonyms.txt">‡∞∏‡∞Æ‡∞æ‡∞® ‡∞∂‡∞¨‡±ç‡∞¶ ‡∞™‡∞¶‡∞æ‡∞≤‡±Å (Homonyms)</option>
      <option value="derivatives.txt">‡∞â‡∞§‡±ç‡∞™‡∞®‡±ç‡∞® ‡∞™‡∞¶‡∞æ‡∞≤‡±Å (Derivatives)</option>
    </select>
    <input id="search" type="text" placeholder="Search within category‚Ä¶" />
  </header>

  <main>
    <ul id="list"><li class="empty">‡∞µ‡∞∞‡±ç‡∞ó‡∞Ç ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø‚Ä¶</li></ul>
  </main>

  <!-- Modal -->
  <div class="overlay" id="overlay"></div>
  <div class="popup" id="popup">
    <header>
      <h2 id="pWord"></h2>
      <button class="btn-close" onclick="closePopup()">Close</button>
    </header>
    <div class="body">
      <div class="meta" id="pRole"></div>
      <div id="pMeaning"></div>
      <div id="pExample" class="meta" style="margin-top:8px;"></div>
    </div>
  </div>

  <script>
    const category = document.getElementById('category');
    const search = document.getElementById('search');
    const list = document.getElementById('list');
    const overlay = document.getElementById('overlay');
    const popup = document.getElementById('popup');
    const pWord = document.getElementById('pWord');
    const pRole = document.getElementById('pRole');
    const pMeaning = document.getElementById('pMeaning');
    const pExample = document.getElementById('pExample');

    let rawLines = [];

    // Load selected file
    async function loadFile(filename) {
      list.innerHTML = '<li class="empty">Loading‚Ä¶</li>';
      try {
        const res = await fetch(filename, { cache: 'no-store' });
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const text = await res.text();
        rawLines = text.split(/\r?\n/).map(s => s.trim()).filter(Boolean);
        renderList(rawLines);
      } catch (e) {
        list.innerHTML = `<li class="empty">‚ùå Could not load <b>${filename}</b> (${e.message})</li>`;
      }
    }

    function renderList(lines) {
      if (!lines.length) { list.innerHTML = '<li class="empty">No entries</li>'; return; }
      list.innerHTML = '';
      lines.forEach(line => {
        const li = document.createElement('li');
        li.textContent = line;
        li.addEventListener('click', () => openPopupFromLine(line));
        list.appendChild(li);
      });
    }

    // Search filter (within loaded file)
    search.addEventListener('input', () => {
      const q = search.value.trim();
      if (!q) { renderList(rawLines); return; }
      const re = new RegExp(q.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'i');
      renderList(rawLines.filter(l => re.test(l)));
    });

    // Category change
    category.addEventListener('change', e => {
      search.value = '';
      loadFile(e.target.value);
    });

    // Parse & show popup
    function openPopupFromLine(line) {
      let word = '', role = '', meaning = '';

      if (line.includes('√ó')) {
        // antonyms: a (...) √ó b (...)
        const [left, right] = line.split('√ó')
        
