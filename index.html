<!DOCTYPE html>
<html lang="te">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>తెలుగు నిఘంటువు — Dictionary</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+Telugu:wght@400;600&family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body { margin:0; background:#f9f7f1; font-family:"Inter", sans-serif; color:#222; }
    header { padding:12px 16px; background:#fff; border-bottom:1px solid #ddd; position:sticky; top:0; display:flex; align-items:center; gap:12px; z-index:10; }
    h1 { margin:0; font-size:20px; color:#7a2d00; font-weight:700; flex:1; }
    #search { padding:8px 12px; border:1px solid #ccc; border-radius:6px; font-size:14px; width:220px; }
    main { max-width:1200px; margin:20px auto; padding:0 16px; }
    .sheet { background:#fff; border:1px solid #ddd; border-radius:12px; box-shadow:0 4px 12px #0001; padding:20px; max-height:80vh; overflow-y:auto; }
    .columns { display:flex; flex-wrap:wrap; gap:16px; }
    .group { flex:1 1 calc(50% - 16px); background:#fafafa; border:1px solid #e0e0e0; border-radius:8px; padding:12px 14px; font-size:14px; line-height:1.5; scroll-margin-top:80px; transition:background .3s; }
    .highlight { background:yellow; }
  </style>
</head>
<body>
  <header>
    <h1>తెలుగు నిఘంటువు • Web</h1>
    <input id="search" type="text" placeholder="Search word…" />
  </header>
  <main>
    <section class="sheet">
      <div id="dict" class="columns"></div>
    </section>
  </main>

  <script>
    let entries = [];

    async function loadDictionary(){
      try {
        const res = await fetch('dictionary.json');
        entries = await res.json();
        render(entries);
      } catch(err){
        document.getElementById('dict').innerHTML = '<p>Could not load dictionary.json</p>';
      }
    }

    function render(list){
      const dictEl = document.getElementById('dict');
      dictEl.innerHTML = '';
      list.forEach((text, idx) => {
        const box = document.createElement('div');
        box.className = 'group';
        box.id = 'box-' + idx;
        box.textContent = text;
        dictEl.appendChild(box);
      });
    }

    // Fuzzy search helper (Levenshtein distance)
    function levenshtein(a, b){
      const m = a.length, n = b.length;
      const dp = Array.from({length:m+1},()=>Array(n+1).fill(0));
      for(let i=0;i<=m;i++) dp[i][0]=i;
      for(let j=0;j<=n;j++) dp[0][j]=j;
      for(let i=1;i<=m;i++){
        for(let j=1;j<=n;j++){
          if(a[i-1]===b[j-1]) dp[i][j]=dp[i-1][j-1];
          else dp[i][j]=1+Math.min(dp[i-1][j],dp[i][j-1],dp[i-1][j-1]);
        }
      }
      return dp[m][n];
    }

    function fuzzyMatch(term, text){
      term = term.toLowerCase();
      text = text.toLowerCase();
      if(text.includes(term)) return 0;
      return levenshtein(term, text);
    }

    const searchInput = document.getElementById('search');
    searchInput.addEventListener('keydown', e => {
      if(e.key==='Enter'){
        const term = searchInput.value.trim();
        if(!term) return;
        let best = {idx:null, score:Infinity};
        entries.forEach((txt, idx) => {
          const score = fuzzyMatch(term, txt);
          if(score < best.score) best = {idx, score};
        });
        if(best.idx!==null){
          const el = document.getElementById('box-' + best.idx);
          el.scrollIntoView({behavior:'smooth', block:'start'});
          el.classList.add('highlight');
          setTimeout(()=>el.classList.remove('highlight'),2000);
        } else {
          alert('Not found');
        }
      }
    });

    loadDictionary();
  </script>
</body>
</html>
